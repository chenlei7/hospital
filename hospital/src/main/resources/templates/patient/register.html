<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh-CN">
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>挂号</title>
    <!-- Fav  Icon Link -->
    <link rel="shortcut icon" type="image/png" th:href="@{/images/fav.png}">
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <!-- themify icons CSS -->
    <link rel="stylesheet" th:href="@{/css/themify-icons.css}">
    <!-- Animations CSS -->
    <link rel="stylesheet" th:href="@{/css/animate.css}">
    <!-- Main CSS -->
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <link rel="stylesheet" th:href="@{/css/green.css}" id="style_theme">
    <link rel="stylesheet" th:href="@{/css/responsive.css}">
    <!-- morris charts -->
    <link rel="stylesheet" th:href="@{/charts/css/morris.css}">
    <!-- jvectormap -->
    <link rel="stylesheet" th:href="@{/css/jquery-jvectormap.css}">
    <link rel="stylesheet" th:href="@{/datatable/dataTables.bootstrap4.min.css}">

    <script th:src="@{/js/modernizr.min.js}"></script>
</head>

<body>
<!-- Pre Loader -->
<div class="loading">
    <div class="spinner">
        <div class="double-bounce1"></div>
        <div class="double-bounce2"></div>
    </div>
</div>
<!--/Pre Loader -->
<!-- Color Changer -->
<div class="theme-settings" id="switcher">
		<span class="theme-click">
			<span class="ti-settings"></span>
		</span>
    <span class="theme-color theme-default theme-active" data-color="green"></span>
    <span class="theme-color theme-blue" data-color="blue"></span>
    <span class="theme-color theme-red" data-color="red"></span>
    <span class="theme-color theme-violet" data-color="violet"></span>
    <span class="theme-color theme-yellow" data-color="yellow"></span>
</div>
<!-- /Color Changer -->
<div class="wrapper">
    <!-- Page Content -->
    <div id="content">
        <!-- Top Navigation -->
        <div class="container top-brand">
            <nav class="navbar navbar-default">
                <div class="navbar-header">
                    <div class="sidebar-header"><a th:href="@{/patient/index}"><img th:src="@{/images/logo-dark.png}"
                                                                                    class="logo" alt="logo"></a>
                    </div>
                </div>
                <ul class="nav justify-content-end">
                    <li class="nav-item">
                        <a class="nav-link">
                            <span title="Fullscreen" class="ti-fullscreen fullscreen"></span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="modal" data-target=".lochana-modal-lg">
                            <span class="ti-search"></span>
                        </a>
                        <div class="modal fade lochana-modal-lg" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-lorvens">
                                <div class="modal-content lochana-box-shadow2">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Search Patient/医生:</h5>
                                        <span class="ti-close" data-dismiss="modal" aria-label="Close">
												</span>
                                    </div>
                                    <div class="modal-body">
                                        <form>
                                            <div class="form-group">
                                                <input type="text" class="form-control" id="search-term"
                                                       placeholder="Type text here">
                                                <button type="button" class="btn btn-lorvens lochana-bg">
                                                    <span class="ti-location-arrow"></span> Search
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button"
                           aria-haspopup="true"
                           aria-expanded="false">
                            <span class="ti-announcement"></span>
                        </a>
                        <div class="dropdown-menu lochana-box-shadow2 notifications animated flipInY">
                            <h5>Notifications</h5>
                            <a class="dropdown-item" href="#">
                                <span class="ti-wheelchair"></span> New Patient Added</a>
                            <a class="dropdown-item" href="#">
                                <span class="ti-money"></span> Patient payment done</a>
                            <a class="dropdown-item" href="#">
                                <span class="ti-time"></span>Patient Appointment booked</a>
                            <a class="dropdown-item" href="#">
                                <span class="ti-wheelchair"></span> New Patient Added</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button"
                           aria-haspopup="true"
                           aria-expanded="false">
                            <span class="ti-user"></span>
                        </a>
                        <div class="dropdown-menu lochana-box-shadow2 profile animated flipInY">
                            <h5>John Willing</h5>
                            <a class="dropdown-item" href="#">
                                <span class="ti-settings"></span> Settings</a>
                            <a class="dropdown-item" href="#">
                                <span class="ti-help-alt"></span> Help</a>
                            <a class="dropdown-item" href="#">
                                <span class="ti-power-off"></span> Logout</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>
        <!-- /Top Navigation -->
        <!-- Menu -->

        <!-- /Page Title -->

        <!-- /Breadcrumb -->
        <!-- Main Content -->
        <div class="container">

            <div class="row">
                <!-- Widget Item -->
                <div class="col-md-12">
                    <div class="widget-area-2 lochana-box-shadow">
                        <h3 class="widget-title">请填写挂号信息</h3>
                        <form action="/register/registerAdd" method="post" onsubmit="return check()">
                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="patientName">姓名</label>
                                    <input type="text" class="form-control" placeholder="patientName" id="patientName"
                                           name="patientName">
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="patientAge">年龄</label>
                                    <input type="text" class="form-control" placeholder="patientAge" id="patientAge"
                                           name="patientAge">
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="patientAddress">地址</label>
                                    <input type="text" placeholder="patientAddress" class="form-control"
                                           id="patientAddress" name="patientAddress">
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="patientComeDate">来的日期</label>
                                    <input type="date" placeholder="patientComeDate" class="form-control"
                                           id="patientComeDate" name="patientComeDate">
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="patientPhone">电话</label>
                                    <input type="text" placeholder="patientPhone" class="form-control" id="patientPhone"
                                           name="patientPhone">
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="patientGender">性别</label>
                                    <select class="form-control" id="patientGender" name="patientGender">
                                        <option>男</option>
                                        <option>女</option>
                                        <option>其它</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="patientRoomNum" >选择科室</label>
                                    <select class="form-control" id="patientRoomNum" name="patientRoomNum">
                                        <option value="" id="select1">选择科室</option>
                                        <option th:each="r:${rooms}" th:value="${r.roomPosition}"
                                                th:text="${r.roomPosition}"></option>
                                    </select>
                                </div>
                                <div class="form-group col-md-6" id="btnDoctor">
                                    <label for="patientPhone">可选专家号</label>
                                    <input style="background-color: #00C2FF" type="button" placeholder="patientPhone" class="form-control" name="patientPhone" onclick="doDoctor()" value="专家号">
                                </div>
                                <div class="form-group col-md-6" id="doctor" style="display: none">
                                    <label for="patientDoctorNum">选择医生</label>
                                    <select class="form-control" id="patientDoctorNum" name="patientDoctorNum">
                                        <option value="">选择医生</option>
                                        <option th:each="d:${doctors}" th:value="${d.doctorNum}"
                                                th:text="${d.doctorName}"></option>
                                    </select>
                                </div>
                                <div class="form-group col-md-6 mb-3">
                                    <button type="submit" class="btn btn-primary btn-lg">提交</button>
                                </div>
                            </div>
                        </form>

                    </div>
                </div>
                <!-- /Widget Item -->
            </div>
        </div>
        <!-- /Main Content -->
        <!--Copy Rights-->

        <!-- /Copy Rights-->
    </div>
    <!-- /Page Content -->
</div>
<!-- Back to Top -->

<!-- /Back to Top -->
<!-- Jquery Library-->
<script th:src="@{/js/jquery-3.2.1.min.js}"></script>
<!-- Popper Library-->
<script th:src="@{/js/popper.min.js}"></script>
<!-- Bootstrap Library-->
<script th:src="@{/js/bootstrap.min.js}"></script>

<!-- Datatable  -->
<script th:src="@{/datatable/jquery.dataTables.min.js}"></script>
<script th:src="@{/datatable/dataTables.bootstrap4.min.js}"></script>

<!-- Custom Script-->
<script th:src="@{/js/custom.js}"></script>

<script th:inline="javascript">
    //专家号
    function doDoctor() {
        var msg = "专家号可能参生更高的挂号费，您确定要选择专家号码？\n\n请确认！";
        if (confirm(msg) == true) {
            document.getElementById("btnDoctor").style.display="none";
            document.getElementById("patientRoomNum").options[0].selected = true;
            $("#doctor").show();
            alert("请先重新选择科室哦!");
            //调用联动方法
            m();
        } else {
            return false;
        }
    }

    //科室联动专家
    function m(){
    $("#patientRoomNum").change(function () {
        var room = $("#patientRoomNum").val();
        if (room == " " || room == '选择科室') {
            return;
        }
        console.log("我是" + room);
        $.ajax({
            cache: true,
            type: "get",
            url: "/register/findDoctor",
            data: {"room": room},
            success: function (data) {
                console.log(data);
                var patientDoctorNum = $("#patientDoctorNum").empty();
                for (var i = 0; i < data.length; i++) {
                    patientDoctorNum.append("<option value ='" + data[i].doctorNum + "'>" + data[i].doctorName + "</option>");
                }
            },
            error: function () {
                notifyError("获取数据失败，请重新刷新！")
            }
        })
    })
    }

</script>

</body>

</html>